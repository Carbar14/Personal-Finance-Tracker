<!-- layout -->
{% extends "layout.html" %}

<!-- Main -->

{% block body %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.0/dist/chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>

<div class="cont center">
  <canvas id="myChart" style="height: 50vh; max-height: 600px"></canvas>

  <script>
    const xValues = ["Italy", "France", "Spain", "USA", "Argentina"];
    const yValues = [55, 49, 44, 24, 15, 15];
    const barColors = [
      "rgba(0,0,255,1.0)",
      "rgba(0,0,255,0.8)",
      "rgba(0,0,255,0.6)",
      "rgba(0,0,255,0.4)",
      "rgba(0,0,255,0.2)",
    ];
    const data = {
      labels: xValues,
      datasets: [
        {
          backgroundColor: barColors,
          data: yValues,
        },
      ],
    };

    const config = {
      type: "pie",
      data,
      options: {
        title: {
          responive: true,
          display: true,
          text: "World Wide Wine Production 2018",
        },
        plugins: {
          tooltip: {
            enabled: true,
          },

          datalabels: {
            formatter: (value, context) => {
              const datapoints = context.chart.data.datasets[0].data;
              function totalSum(total, datapoint) {
                return total + datapoint;
              }
              const totalValue = datapoints.reduce(totalSum, 0);
              const percentageValue = ((value / totalValue) * 100).toFixed(1);
              return `${percentageValue}%`;
            },
          },
        },
      },
      plugins: [ChartDataLabels],
    };

    const myChart = new Chart(document.getElementById("myChart"), config);
  </script>
</div>
{% endblock %}
